<!-- <script nonce="{{ csp_nonce() }}">
  document.addEventListener("DOMContentLoaded", function() {
    console.log("âœ… tail_js_custom_extra.html loaded!");

    const interval = setInterval(() => {
      const logoutLink = document.querySelector("a[href='/logout/']");
      if (logoutLink) {
        clearInterval(interval);
        console.log("ğŸ¯ Found logout link:", logoutLink);
        logoutLink.textContent = "ğŸšª Logout Superset + Keycloak";
        logoutLink.addEventListener("click", async function(e) {
          e.preventDefault();
          console.log("ğŸšª Custom Logout clicked!");

          // 1. Láº¥y logout_url tá»« backend (cÃ³ id_token_hint náº¿u cÃ³)
          const resp = await fetch("/api/get-logout-url", { credentials: "include" });
          const data = await resp.json();
          const logoutUrl = data.logout_url;
          console.log("ğŸ”— Logout URL:", logoutUrl);

          const w = 500, h = 400;
          const left = (screen.width - w) / 2;
          const top = (screen.height - h) / 2;

          // 2. Má»Ÿ popup Keycloak logout
          window.open(
            logoutUrl,
            "KeycloakLogout",
            `width=${w},height=${h},top=${top},left=${left}`
          );
        });
      }
    }, 500);

    // 4. Nghe sá»± kiá»‡n tá»« popup Keycloak
    window.addEventListener("message", (event) => {
      console.log("ğŸ“© Received message:", event.data);
      if (event.data === "kc-logout-success") {
        console.log("ğŸŸ¢ Keycloak logout thÃ nh cÃ´ng â†’ reload Superset");
        window.location.href = "/login/";
      }
    });
  });
</script> -->
