<!-- <script nonce="{{ csp_nonce() }}">
  document.addEventListener("DOMContentLoaded", function() {
    console.log("✅ tail_js_custom_extra.html loaded!");

    const interval = setInterval(() => {
      const logoutLink = document.querySelector("a[href='/logout/']");
      if (logoutLink) {
        clearInterval(interval);
        console.log("🎯 Found logout link:", logoutLink);
        logoutLink.textContent = "🚪 Logout Superset + Keycloak";
        logoutLink.addEventListener("click", async function(e) {
          e.preventDefault();
          console.log("🚪 Custom Logout clicked!");

          // 1. Lấy logout_url từ backend (có id_token_hint nếu có)
          const resp = await fetch("/api/get-logout-url", { credentials: "include" });
          const data = await resp.json();
          const logoutUrl = data.logout_url;
          console.log("🔗 Logout URL:", logoutUrl);

          const w = 500, h = 400;
          const left = (screen.width - w) / 2;
          const top = (screen.height - h) / 2;

          // 2. Mở popup Keycloak logout
          window.open(
            logoutUrl,
            "KeycloakLogout",
            `width=${w},height=${h},top=${top},left=${left}`
          );
        });
      }
    }, 500);

    // 4. Nghe sự kiện từ popup Keycloak
    window.addEventListener("message", (event) => {
      console.log("📩 Received message:", event.data);
      if (event.data === "kc-logout-success") {
        console.log("🟢 Keycloak logout thành công → reload Superset");
        window.location.href = "/login/";
      }
    });
  });
</script> -->
